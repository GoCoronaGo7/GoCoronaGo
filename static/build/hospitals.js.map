{"version":3,"sources":["../../client/src/hospitals.jsx"],"names":["Dropdown","LoadingIcon","SearchBar","HospitalsDisplay","useEffect","useState","useReducer","React","apiUrl","location","origin","cache","Map","document","addEventListener","ReactDOM","render","getElementById","Hospitals","region","setRegion","STATS_DATA","state_names","searchQuery","hospitals","filtered","setSearchQuery","updateHospitals","error","setError","fetchedRegion","getRegionDataByName","then","resData","values","data","catch","console","display","placeItems","value","RegionDropDown","regions","Set","map","x","area","type","propTypes","PropTypes","object","func","isRequired","state","action","filterHospitals","Object","Error","length","filter","hospital_name","toLowerCase","includes","name","code","code_names","indexOf","cachedData","get","fetch","json"],"mappings":"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","sourcesContent":["import Dropdown from './components/Dropdown.js'\nimport LoadingIcon from './components/LoadingIcon.js'\nimport SearchBar from './components/SearchBar.js'\nimport HospitalsDisplay from './components/HospitalDisplay.js'\n\nconst { useEffect, useState, useReducer } = React\n\nconst apiUrl = location.origin + '/api/data'\nconst cache = new Map()\n\ndocument.addEventListener('DOMContentLoaded', function () {\n    ReactDOM.render(<Hospitals />, document.getElementById('root'))\n})\n\nfunction Hospitals () {\n    const [region, setRegion] = useState(STATS_DATA.state_names[15])\n    const [{ searchQuery, hospitals, filtered }, setSearchQuery] = useReducer(updateHospitals, { searchQuery: '', hospitals: null, filtered: null, region: null })\n    const [error, setError] = useState('')\n\n    useEffect(() => {\n        const fetchedRegion = region\n        getRegionDataByName(fetchedRegion)\n            .then(resData => {\n                resData ||= 'Failed to fetch Data'\n                if (typeof resData === 'string') return setError(resData + ', Contact a developer if the issue persists')\n                setSearchQuery({ values: resData.data, region: fetchedRegion })\n            })\n            .catch(console.error)\n    }, [region])\n\n    if (error) return <span color='red'> {error} </span>\n    if (!hospitals || hospitals.region !== region) return <div id=\"loadingDisplay\" style={{ display: 'grid', placeItems: 'center' }} > < LoadingIcon /> </div>\n    return (\n        <div id=\"display\">\n            < SearchBar searchQuery={searchQuery} setSearchQuery={setSearchQuery} />\n            <div id=\"dropDown-bar\">\n                < Dropdown options={STATS_DATA.state_names} value={region} onChange={({ value }) => setRegion(value)} />\n                < RegionDropDown hospitals={hospitals} setSearchQuery={setSearchQuery} />\n            </div>\n            < HospitalsDisplay hospitals={filtered} />\n        </div>\n    )\n}\n\nfunction RegionDropDown ({ hospitals, setSearchQuery }) {\n    const [regions, setRegion] = useState(null)\n    useEffect(() => {\n        setRegion(['All Regions', ...new Set(hospitals.values.map(x => x.area))])\n    }, [hospitals])\n    if (!hospitals || !regions) return <div id=\"loadingDisplay\" style={{ display: 'grid', placeItems: 'center' }} > < LoadingIcon /> </div>\n    else return < Dropdown options={regions} value={'All Regions'} onChange={({ value }) => setSearchQuery({ type: 'region', region: value })}/>\n}\nRegionDropDown.propTypes = {\n    hospitals: PropTypes.object,\n    setSearchQuery: PropTypes.func.isRequired\n}\n\nfunction updateHospitals (state, action) {\n    // update search Query\n    if (typeof action === 'string' || !action) return { ...state, searchQuery: action, filtered: filterHospitals(state.hospitals, action, state.region) }\n    else if (action instanceof Object && action.values && action.region) return { ...state, hospitals: action, filtered: filterHospitals(action, state.searchQuery, state.region) }\n    else if (action instanceof Object && action.type === 'region' && action.region) return { ...state, region: action.region, filtered: filterHospitals(state.hospitals, state.searchQuery, action.region) }\n    else throw new Error()\n}\n\nfunction filterHospitals (hospitals, action, region) {\n    if (!hospitals || hospitals.values?.length === 0) return []\n    let filtered = hospitals.values\n    if (region && region !== 'All Regions') filtered = filtered.filter(x => x.area === region)\n    if (!action || action === '') return filtered\n\n    filtered = filtered.filter(x => x.hospital_name.toLowerCase().includes(action.toLowerCase()))\n    return filtered\n}\n\nasync function getRegionDataByName (name) {\n    const code = STATS_DATA.code_names[STATS_DATA.state_names.indexOf(name)]\n    if (!code) return 'Invalid State Name'\n    const cachedData = cache.get(code)\n    if (cachedData) return cachedData\n    const data = await fetch(`${apiUrl}?name=${code}`).then(x => x.json()).catch(console.error)\n    if (!data) return 'Failed to fetch data from API'\n    return data\n}\n"],"file":"hospitals.js"}