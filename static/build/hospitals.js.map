{"version":3,"sources":["../../client/src/hospitals.jsx"],"names":["Dropdown","LoadingIcon","SearchBar","HospitalsDisplay","useEffect","useState","useReducer","React","apiUrl","location","origin","cache","Map","document","addEventListener","ReactDOM","render","getElementById","Hospitals","region","setRegion","STATS_DATA","state_names","searchQuery","hospitals","filtered","setSearchQuery","updateHospitals","error","setError","fetchedRegion","getRegionDataByName","then","resData","data","sort","a","b","available_beds_with_oxygen","console","log","values","catch","display","placeItems","value","RegionDropDown","regions","Set","map","x","area","type","propTypes","PropTypes","object","func","isRequired","state","action","filterHospitals","Object","Error","length","filter","hospital_name","toLowerCase","includes","name","code","code_names","indexOf","cachedData","get","fetch","json"],"mappings":"AAAA,OAAOA,QAAP,MAAqB,0BAArB;AACA,OAAOC,WAAP,MAAwB,6BAAxB;AACA,OAAOC,SAAP,MAAsB,2BAAtB;AACA,OAAOC,gBAAP,MAA6B,iCAA7B;AAEA,MAAM;AAAEC,EAAAA,SAAF;AAAaC,EAAAA,QAAb;AAAuBC,EAAAA;AAAvB,IAAsCC,KAA5C;AAEA,MAAMC,MAAM,GAAGC,QAAQ,CAACC,MAAT,GAAkB,WAAjC;AACA,MAAMC,KAAK,GAAG,IAAIC,GAAJ,EAAd;AAEAC,QAAQ,CAACC,gBAAT,CAA0B,kBAA1B,EAA8C,YAAY;AACtDC,EAAAA,QAAQ,CAACC,MAAT,eAAgB,oBAAC,SAAD,OAAhB,EAA+BH,QAAQ,CAACI,cAAT,CAAwB,MAAxB,CAA/B;AACH,CAFD;;AAIA,SAASC,SAAT,GAAsB;AAClB,QAAM,CAACC,MAAD,EAASC,SAAT,IAAsBf,QAAQ,CAACgB,UAAU,CAACC,WAAX,CAAuB,EAAvB,CAAD,CAApC;AACA,QAAM,CAAC;AAAEC,IAAAA,WAAF;AAAeC,IAAAA,SAAf;AAA0BC,IAAAA;AAA1B,GAAD,EAAuCC,cAAvC,IAAyDpB,UAAU,CAACqB,eAAD,EAAkB;AAAEJ,IAAAA,WAAW,EAAE,EAAf;AAAmBC,IAAAA,SAAS,EAAE,IAA9B;AAAoCC,IAAAA,QAAQ,EAAE,IAA9C;AAAoDN,IAAAA,MAAM,EAAE;AAA5D,GAAlB,CAAzE;AACA,QAAM,CAACS,KAAD,EAAQC,QAAR,IAAoBxB,QAAQ,CAAC,EAAD,CAAlC;AAEAD,EAAAA,SAAS,CAAC,MAAM;AACZ,UAAM0B,aAAa,GAAGX,MAAtB;AACAY,IAAAA,mBAAmB,CAACD,aAAD,CAAnB,CACKE,IADL,CACUC,OAAO,IAAI;AACbA,MAAAA,OAAO,KAAK,sBAAZ;AACA,UAAI,OAAOA,OAAP,KAAmB,QAAvB,EAAiC,OAAOJ,QAAQ,CAACI,OAAO,GAAG,6CAAX,CAAf;AACjCA,MAAAA,OAAO,CAACC,IAAR,GAAeD,OAAO,CAACC,IAAR,CAAaC,IAAb,CAAkB,CAACC,CAAD,EAAIC,CAAJ,KAAUA,CAAC,CAACC,0BAAF,GAA+BF,CAAC,CAACE,0BAA7D,CAAf;AACAC,MAAAA,OAAO,CAACC,GAAR,CAAYP,OAAO,CAACC,IAApB;AACAR,MAAAA,cAAc,CAAC;AAAEe,QAAAA,MAAM,EAAER,OAAO,CAACC,IAAlB;AAAwBf,QAAAA,MAAM,EAAEW;AAAhC,OAAD,CAAd;AACH,KAPL,EAQKY,KARL,CAQWH,OAAO,CAACX,KARnB;AASH,GAXQ,EAWN,CAACT,MAAD,CAXM,CAAT;AAaA,MAAIS,KAAJ,EAAW,oBAAO;AAAM,IAAA,KAAK,EAAC;AAAZ,UAAoBA,KAApB,MAAP;AACX,MAAI,CAACJ,SAAD,IAAcA,SAAS,CAACL,MAAV,KAAqBA,MAAvC,EAA+C,oBAAO;AAAK,IAAA,EAAE,EAAC,gBAAR;AAAyB,IAAA,KAAK,EAAE;AAAEwB,MAAAA,OAAO,EAAE,MAAX;AAAmBC,MAAAA,UAAU,EAAE;AAA/B;AAAhC,uBAA6E,oBAAE,WAAF,OAA7E,MAAP;AAC/C,sBACI;AAAK,IAAA,EAAE,EAAC;AAAR,kBACI,oBAAE,SAAF;AAAY,IAAA,WAAW,EAAErB,WAAzB;AAAsC,IAAA,cAAc,EAAEG;AAAtD,IADJ,eAEI;AAAK,IAAA,EAAE,EAAC;AAAR,kBACI,oBAAE,QAAF;AAAW,IAAA,OAAO,EAAEL,UAAU,CAACC,WAA/B;AAA4C,IAAA,KAAK,EAAEH,MAAnD;AAA2D,IAAA,QAAQ,EAAE,CAAC;AAAE0B,MAAAA;AAAF,KAAD,KAAezB,SAAS,CAACyB,KAAD;AAA7F,IADJ,eAEI,oBAAE,cAAF;AAAiB,IAAA,SAAS,EAAErB,SAA5B;AAAuC,IAAA,cAAc,EAAEE;AAAvD,IAFJ,CAFJ,eAMI,oBAAE,gBAAF;AAAmB,IAAA,SAAS,EAAED;AAA9B,IANJ,CADJ;AAUH;;AAED,SAASqB,cAAT,CAAyB;AAAEtB,EAAAA,SAAF;AAAaE,EAAAA;AAAb,CAAzB,EAAwD;AACpD,QAAM,CAACqB,OAAD,EAAU3B,SAAV,IAAuBf,QAAQ,CAAC,IAAD,CAArC;AACAD,EAAAA,SAAS,CAAC,MAAM;AACZgB,IAAAA,SAAS,CAAC,CAAC,aAAD,EAAgB,GAAG,IAAI4B,GAAJ,CAAQxB,SAAS,CAACiB,MAAV,CAAiBQ,GAAjB,CAAqBC,CAAC,IAAIA,CAAC,CAACC,IAAF,IAAU,IAApC,CAAR,CAAnB,CAAD,CAAT;AACH,GAFQ,EAEN,CAAC3B,SAAD,CAFM,CAAT;AAGAe,EAAAA,OAAO,CAACC,GAAR,CAAYO,OAAZ;AACA,MAAI,CAACvB,SAAD,IAAc,CAACuB,OAAnB,EAA4B,oBAAO;AAAK,IAAA,EAAE,EAAC,gBAAR;AAAyB,IAAA,KAAK,EAAE;AAAEJ,MAAAA,OAAO,EAAE,MAAX;AAAmBC,MAAAA,UAAU,EAAE;AAA/B;AAAhC,uBAA6E,oBAAE,WAAF,OAA7E,MAAP,CAA5B,KACK,oBAAO,oBAAE,QAAF;AAAW,IAAA,OAAO,EAAEG,OAApB;AAA6B,IAAA,KAAK,EAAE,aAApC;AAAmD,IAAA,QAAQ,EAAE,CAAC;AAAEF,MAAAA;AAAF,KAAD,KAAenB,cAAc,CAAC;AAAE0B,MAAAA,IAAI,EAAE,QAAR;AAAkBjC,MAAAA,MAAM,EAAE0B;AAA1B,KAAD;AAA1F,IAAP;AACR;;AACDC,cAAc,CAACO,SAAf,GAA2B;AACvB7B,EAAAA,SAAS,EAAE8B,SAAS,CAACC,MADE;AAEvB7B,EAAAA,cAAc,EAAE4B,SAAS,CAACE,IAAV,CAAeC;AAFR,CAA3B;;AAKA,SAAS9B,eAAT,CAA0B+B,KAA1B,EAAiCC,MAAjC,EAAyC;AACrC;AACA,MAAI,OAAOA,MAAP,KAAkB,QAAlB,IAA8B,CAACA,MAAnC,EAA2C,OAAO,EAAE,GAAGD,KAAL;AAAYnC,IAAAA,WAAW,EAAEoC,MAAzB;AAAiClC,IAAAA,QAAQ,EAAEmC,eAAe,CAACF,KAAK,CAAClC,SAAP,EAAkBmC,MAAlB,EAA0BD,KAAK,CAACvC,MAAhC;AAA1D,GAAP,CAA3C,KACK,IAAIwC,MAAM,YAAYE,MAAlB,IAA4BF,MAAM,CAAClB,MAAnC,IAA6CkB,MAAM,CAACxC,MAAxD,EAAgE,OAAO,EAAE,GAAGuC,KAAL;AAAYlC,IAAAA,SAAS,EAAEmC,MAAvB;AAA+BlC,IAAAA,QAAQ,EAAEmC,eAAe,CAACD,MAAD,EAASD,KAAK,CAACnC,WAAf,EAA4BmC,KAAK,CAACvC,MAAlC;AAAxD,GAAP,CAAhE,KACA,IAAIwC,MAAM,YAAYE,MAAlB,IAA4BF,MAAM,CAACP,IAAP,KAAgB,QAA5C,IAAwDO,MAAM,CAACxC,MAAnE,EAA2E,OAAO,EAAE,GAAGuC,KAAL;AAAYvC,IAAAA,MAAM,EAAEwC,MAAM,CAACxC,MAA3B;AAAmCM,IAAAA,QAAQ,EAAEmC,eAAe,CAACF,KAAK,CAAClC,SAAP,EAAkBkC,KAAK,CAACnC,WAAxB,EAAqCoC,MAAM,CAACxC,MAA5C;AAA5D,GAAP,CAA3E,KACA,MAAM,IAAI2C,KAAJ,EAAN;AACR;;AAED,SAASF,eAAT,CAA0BpC,SAA1B,EAAqCmC,MAArC,EAA6CxC,MAA7C,EAAqD;AACjD,MAAI,CAACK,SAAD,IAAcA,SAAS,CAACiB,MAAV,EAAkBsB,MAAlB,KAA6B,CAA/C,EAAkD,OAAO,EAAP;AAClD,MAAItC,QAAQ,GAAGD,SAAS,CAACiB,MAAzB;AACA,MAAItB,MAAM,IAAIA,MAAM,KAAK,aAAzB,EAAwCM,QAAQ,GAAGA,QAAQ,CAACuC,MAAT,CAAgBd,CAAC,IAAIA,CAAC,CAACC,IAAF,KAAWhC,MAAhC,CAAX;AACxC,MAAI,CAACwC,MAAD,IAAWA,MAAM,KAAK,EAA1B,EAA8B,OAAOlC,QAAP;AAE9BA,EAAAA,QAAQ,GAAGA,QAAQ,CAACuC,MAAT,CAAgBd,CAAC,IAAIA,CAAC,CAACe,aAAF,CAAgBC,WAAhB,GAA8BC,QAA9B,CAAuCR,MAAM,CAACO,WAAP,EAAvC,CAArB,CAAX;AACA,SAAOzC,QAAP;AACH;;AAED,eAAeM,mBAAf,CAAoCqC,IAApC,EAA0C;AACtC,QAAMC,IAAI,GAAGhD,UAAU,CAACiD,UAAX,CAAsBjD,UAAU,CAACC,WAAX,CAAuBiD,OAAvB,CAA+BH,IAA/B,CAAtB,CAAb;AACA,MAAI,CAACC,IAAL,EAAW,OAAO,oBAAP;AACX,QAAMG,UAAU,GAAG7D,KAAK,CAAC8D,GAAN,CAAUJ,IAAV,CAAnB;AACA,MAAIG,UAAJ,EAAgB,OAAOA,UAAP;AAChB,QAAMtC,IAAI,GAAG,MAAMwC,KAAK,CAAE,GAAElE,MAAO,SAAQ6D,IAAK,EAAxB,CAAL,CAAgCrC,IAAhC,CAAqCkB,CAAC,IAAIA,CAAC,CAACyB,IAAF,EAA1C,EAAoDjC,KAApD,CAA0DH,OAAO,CAACX,KAAlE,CAAnB;AACA,MAAI,CAACM,IAAL,EAAW,OAAO,+BAAP;AAEX,SAAOA,IAAP;AACH","sourcesContent":["import Dropdown from './components/Dropdown.js'\nimport LoadingIcon from './components/LoadingIcon.js'\nimport SearchBar from './components/SearchBar.js'\nimport HospitalsDisplay from './components/HospitalDisplay.js'\n\nconst { useEffect, useState, useReducer } = React\n\nconst apiUrl = location.origin + '/api/data'\nconst cache = new Map()\n\ndocument.addEventListener('DOMContentLoaded', function () {\n    ReactDOM.render(<Hospitals />, document.getElementById('root'))\n})\n\nfunction Hospitals () {\n    const [region, setRegion] = useState(STATS_DATA.state_names[15])\n    const [{ searchQuery, hospitals, filtered }, setSearchQuery] = useReducer(updateHospitals, { searchQuery: '', hospitals: null, filtered: null, region: null })\n    const [error, setError] = useState('')\n\n    useEffect(() => {\n        const fetchedRegion = region\n        getRegionDataByName(fetchedRegion)\n            .then(resData => {\n                resData ||= 'Failed to fetch Data'\n                if (typeof resData === 'string') return setError(resData + ', Contact a developer if the issue persists')\n                resData.data = resData.data.sort((a, b) => b.available_beds_with_oxygen - a.available_beds_with_oxygen)\n                console.log(resData.data)\n                setSearchQuery({ values: resData.data, region: fetchedRegion })\n            })\n            .catch(console.error)\n    }, [region])\n\n    if (error) return <span color='red'> {error} </span>\n    if (!hospitals || hospitals.region !== region) return <div id=\"loadingDisplay\" style={{ display: 'grid', placeItems: 'center' }} > < LoadingIcon /> </div>\n    return (\n        <div id=\"display\">\n            < SearchBar searchQuery={searchQuery} setSearchQuery={setSearchQuery} />\n            <div id=\"dropDown-bar\">\n                < Dropdown options={STATS_DATA.state_names} value={region} onChange={({ value }) => setRegion(value)} />\n                < RegionDropDown hospitals={hospitals} setSearchQuery={setSearchQuery} />\n            </div>\n            < HospitalsDisplay hospitals={filtered } />\n        </div>\n    )\n}\n\nfunction RegionDropDown ({ hospitals, setSearchQuery }) {\n    const [regions, setRegion] = useState(null)\n    useEffect(() => {\n        setRegion(['All Regions', ...new Set(hospitals.values.map(x => x.area || 'NA'))])\n    }, [hospitals])\n    console.log(regions)\n    if (!hospitals || !regions) return <div id=\"loadingDisplay\" style={{ display: 'grid', placeItems: 'center' }} > < LoadingIcon /> </div>\n    else return < Dropdown options={regions} value={'All Regions'} onChange={({ value }) => setSearchQuery({ type: 'region', region: value })} />\n}\nRegionDropDown.propTypes = {\n    hospitals: PropTypes.object,\n    setSearchQuery: PropTypes.func.isRequired\n}\n\nfunction updateHospitals (state, action) {\n    // update search Query\n    if (typeof action === 'string' || !action) return { ...state, searchQuery: action, filtered: filterHospitals(state.hospitals, action, state.region) }\n    else if (action instanceof Object && action.values && action.region) return { ...state, hospitals: action, filtered: filterHospitals(action, state.searchQuery, state.region) }\n    else if (action instanceof Object && action.type === 'region' && action.region) return { ...state, region: action.region, filtered: filterHospitals(state.hospitals, state.searchQuery, action.region) }\n    else throw new Error()\n}\n\nfunction filterHospitals (hospitals, action, region) {\n    if (!hospitals || hospitals.values?.length === 0) return []\n    let filtered = hospitals.values\n    if (region && region !== 'All Regions') filtered = filtered.filter(x => x.area === region)\n    if (!action || action === '') return filtered\n\n    filtered = filtered.filter(x => x.hospital_name.toLowerCase().includes(action.toLowerCase()))\n    return filtered\n}\n\nasync function getRegionDataByName (name) {\n    const code = STATS_DATA.code_names[STATS_DATA.state_names.indexOf(name)]\n    if (!code) return 'Invalid State Name'\n    const cachedData = cache.get(code)\n    if (cachedData) return cachedData\n    const data = await fetch(`${apiUrl}?name=${code}`).then(x => x.json()).catch(console.error)\n    if (!data) return 'Failed to fetch data from API'\n\n    return data\n}\n"],"file":"hospitals.js"}